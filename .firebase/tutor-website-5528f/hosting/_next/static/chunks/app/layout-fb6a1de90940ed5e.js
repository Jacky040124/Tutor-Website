(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3396:function(e,t,r){Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,3881))},5956:function(e,t,r){"use strict";r.d(t,{I8:function(){return s},JU:function(){return n.JU},PL:function(){return n.PL},QT:function(){return n.QT},db:function(){return o},hJ:function(){return n.hJ},pl:function(){return n.pl}});var i=r(2848),n=r(4353),a=r(9271);let u=(0,i.ZF)({apiKey:"AIzaSyDdKApKZNEERKmPLfB8SxlGsJRTZV5ALvc",authDomain:"tutor-website-5528f.firebaseapp.com",projectId:"tutor-website-5528f",storageBucket:"tutor-website-5528f.appspot.com",messagingSenderId:"320690040214",appId:"1:320690040214:web:fde29b5326692c27e981b7",measurementId:"G-J0MZ8W9SSG"}),o=(0,n.ad)(u),s=(0,a.v0)(u)},3881:function(e,t,r){"use strict";r.d(t,{UserProvider:function(){return s},a:function(){return c}});var i=r(7437),n=r(2265),a=r(9271),u=r(5956);let o=(0,n.createContext)();function s(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[c,l]=(0,n.useState)(!0),[d,p]=(0,n.useState)([]),[f,y]=(0,n.useState)({});(0,n.useEffect)(()=>{console.log("UserContext mount");let e=(0,a.Aj)(u.I8,async e=>{if(console.log("Auth state changed:",null==e?void 0:e.uid),e)try{let t=(0,u.JU)(u.db,"users",e.uid),r=(await (0,u.QT)(t)).data();"teacher"===r.type?s({email:e.email,uid:e.uid,type:r.type,nickname:r.nickname,description:r.description,availability:r.availability,pricing:r.pricing}):"student"===r.type&&s({email:e.email,uid:e.uid,type:r.type,nickname:r.nickname,balance:r.balance,bookingHistory:r.bookingHistory})}catch(e){console.error("Error fetching user data:",e)}else s(null);l(!1)});return()=>e()},[]);let b=async(e,t)=>{try{let r=await (0,a.e5)(u.I8,e,t),i=(0,u.JU)(u.db,"users",r.user.uid),n=(await (0,u.QT)(i)).data();return s({email:r.user.email,uid:r.user.uid,type:null==n?void 0:n.type}),p((null==n?void 0:n.availability)||[]),{success:!0,userData:n}}catch(e){return console.error("Error signing in:",e),{success:!1,error:e}}},m=async e=>{if(null==r?void 0:r.uid)try{let t=(0,u.JU)(u.db,"users",r.uid);await (0,u.pl)(t,{availability:e},{merge:!0}),p(e)}catch(e){throw console.error("Error updating availability:",e),e}},h=async e=>{if(null==r?void 0:r.uid)try{let t=(0,u.JU)(u.db,"users",r.uid);await (0,u.pl)(t,{pricing:e},{merge:!0}),s(t=>({...t,pricing:e}))}catch(e){throw console.error("Error updating price:",e),e}},g=async e=>{if(null==r?void 0:r.uid)try{let t=(0,u.JU)(u.db,"users",r.uid);await (0,u.pl)(t,{nickname:e},{merge:!0}),s(t=>({...t,nickname:e}))}catch(e){throw console.error("Error updating nickname:",e),e}},v=async e=>{if(null==r?void 0:r.uid)try{let t=(0,u.JU)(u.db,"users",r.uid);await (0,u.pl)(t,{description:e},{merge:!0}),s(t=>({...t,description:e}))}catch(e){throw console.error("Error updating description:",e),e}},w=async()=>{let e={};return(await (0,u.PL)((0,u.hJ)(u.db,"users"))).forEach(t=>{let r=t.data();"teacher"===r.type&&(e[r.email]=r)}),y(e),e};return(0,i.jsx)(o.Provider,{value:{user:r,setUser:s,loading:c,availability:d,updateAvailability:m,signIn:b,teacherList:f,fetchTeachers:w,updatePrice:h,updateNickname:g,updateDescription:v},children:t})}function c(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},2778:function(){}},function(e){e.O(0,[461,301,83,417,971,117,744],function(){return e(e.s=3396)}),_N_E=e.O()}]);